<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>EzTextRenderer (ez_text_renderer.EzTextRenderer)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">ez_text_renderer</a> &#x00BB; EzTextRenderer</nav><header class="odoc-preamble"><h1>Module <code><span>EzTextRenderer</span></code></h1><p>EzTextRenderer library</p><p>This modules allows to perform text rendering of (UTF-8 encoded) Unicode strings to standard OCaml arrays. It is based on the FreeType library.</p><p>It is currently limited to horizontal left-to-right text layout.</p><p>Error handling is pretty basic: most errors will simply be raised as a Failure exception with an explanatory string. Failed memory allocations will raise Out_of_memory.</p><p>A typical usage is as follows:</p><pre><code>open EzTextRenderer

let black = { blue = 0x00; green = 0x00; red = 0x00; alpha = 0xFF }
let grey = { blue = 0x80; green = 0x80; red = 0x80; alpha = 0xFF }
let white = { blue = 0xFF; green = 0xFF; red = 0xFF; alpha = 0xFF }

let () =
  init ();

  let txt_height = 64 in

  set_font &quot;/usr/share/fonts/truetype/freefont/FreeSerif.ttf&quot; txt_height;

  let text = &quot;Hello World !&quot; in

  let txt_width = compute_text_width text in

  let img_size = { width = txt_width + 16; height = txt_height + 16 } in

  let image = Array.make (img_size.height * img_size.width) grey in

  render_text text black white
    { x = 8; y = 8; width = txt_width; height = txt_height }
    image img_size;

  dump_image image img_size &quot;img.ppm&quot;;

  release ()</code></pre></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-color" class="anchored"><a href="#type-color" class="anchor"></a><code><span><span class="keyword">type</span> color</span><span> = </span><span>{</span></code><table><tr id="type-color.blue" class="anchored"><td class="def record field"><a href="#type-color.blue" class="anchor"></a><code><span>blue : int;</span></code></td></tr><tr id="type-color.green" class="anchored"><td class="def record field"><a href="#type-color.green" class="anchor"></a><code><span>green : int;</span></code></td></tr><tr id="type-color.red" class="anchored"><td class="def record field"><a href="#type-color.red" class="anchor"></a><code><span>red : int;</span></code></td></tr><tr id="type-color.alpha" class="anchored"><td class="def record field"><a href="#type-color.alpha" class="anchor"></a><code><span>alpha : int;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>Representation of a color, where each component must be between 0 and 255</p></div></div><div class="odoc-spec"><div class="spec type" id="type-position" class="anchored"><a href="#type-position" class="anchor"></a><code><span><span class="keyword">type</span> position</span><span> = </span><span>{</span></code><table><tr id="type-position.x" class="anchored"><td class="def record field"><a href="#type-position.x" class="anchor"></a><code><span>x : int;</span></code></td></tr><tr id="type-position.y" class="anchored"><td class="def record field"><a href="#type-position.y" class="anchor"></a><code><span>y : int;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>A position in an image, with (x,y) located at the top-left</p></div></div><div class="odoc-spec"><div class="spec type" id="type-dimension" class="anchored"><a href="#type-dimension" class="anchor"></a><code><span><span class="keyword">type</span> dimension</span><span> = </span><span>{</span></code><table><tr id="type-dimension.width" class="anchored"><td class="def record field"><a href="#type-dimension.width" class="anchor"></a><code><span>width : int;</span></code></td></tr><tr id="type-dimension.height" class="anchored"><td class="def record field"><a href="#type-dimension.height" class="anchor"></a><code><span>height : int;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>An image's dimensions</p></div></div><div class="odoc-spec"><div class="spec type" id="type-area" class="anchored"><a href="#type-area" class="anchor"></a><code><span><span class="keyword">type</span> area</span><span> = </span><span>{</span></code><table><tr id="type-area.x" class="anchored"><td class="def record field"><a href="#type-area.x" class="anchor"></a><code><span>x : int;</span></code></td></tr><tr id="type-area.y" class="anchored"><td class="def record field"><a href="#type-area.y" class="anchor"></a><code><span>y : int;</span></code></td></tr><tr id="type-area.width" class="anchored"><td class="def record field"><a href="#type-area.width" class="anchor"></a><code><span>width : int;</span></code></td></tr><tr id="type-area.height" class="anchored"><td class="def record field"><a href="#type-area.height" class="anchor"></a><code><span>height : int;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>An area of an image, starting at (x,y) and of size (width,height)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-init" class="anchored"><a href="#val-init" class="anchor"></a><code><span><span class="keyword">val</span> init : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Initialize the EzTextRenderer library. Must be called at least once before calling any other function in this module.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-release" class="anchored"><a href="#val-release" class="anchor"></a><code><span><span class="keyword">val</span> release : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Free the EzTextRenderer library. Call it once you're done using the library.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_font" class="anchored"><a href="#val-set_font" class="anchor"></a><code><span><span class="keyword">val</span> set_font : <span>string <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Set the current font, where the first argument is a path to a font file (eg. /usr/share/fonts/truetype/freefont/FreeSerif.ttf) and the second is the font height in pixels.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-compute_text_width" class="anchored"><a href="#val-compute_text_width" class="anchor"></a><code><span><span class="keyword">val</span> compute_text_width : <span>string <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p>Return the width of the specified text in pixels, for the currently selected font. Fails if no font has been selected.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-render_text" class="anchored"><a href="#val-render_text" class="anchor"></a><code><span><span class="keyword">val</span> render_text : 
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-color">color</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-color">color</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-area">area</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-color">color</a> array</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-dimension">dimension</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Render the specified text using the first color as front color and the second as background color in the given area of the provided array, representing an image whose dimensions are given as the last argument. Fails if no font has been selected.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-dump_image" class="anchored"><a href="#val-dump_image" class="anchor"></a><code><span><span class="keyword">val</span> dump_image : <span><span><a href="#type-color">color</a> array</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-dimension">dimension</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Dump the provided array, representing an image whose dimensions are given by the second argument, in a PPM file whose name is given as the last argument.</p></div></div></div></body></html>